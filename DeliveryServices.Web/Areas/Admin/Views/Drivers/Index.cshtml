@model IEnumerable<DeliveryServices.Models.Driver>
@{
    ViewData["Title"] = "Drivers Management";
}

@section PageHeader {
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
          <h1 class="h3 mb-0">Drivers Management</h1>
    <p class="text-muted mb-0">Manage delivery drivers and their salaries</p>
    </div>
  <div>
            <a asp-action="Create" class="btn btn-primary">
 <i class="bi bi-plus-circle"></i> Add New Driver
          </a>
 </div>
    </div>
}

@if (!Model.Any())
{
    <div class="card">
        <div class="card-body text-center py-5">
       <i class="bi bi-truck text-muted" style="font-size: 4rem;"></i>
            <h4 class="mt-3">No Drivers Yet</h4>
            <p class="text-muted">Get started by adding your first driver to the system.</p>
            <a asp-action="Create" class="btn btn-primary mt-3">
     <i class="bi bi-plus-circle"></i> Add First Driver
          </a>
      </div>
 </div>
}
else
{
    <!-- Statistics Cards -->
    <div class="row g-3 mb-4">
        <div class="col-md-3">
          <div class="card">
      <div class="card-body">
    <div class="d-flex align-items-center">
        <div class="stat-card-icon bg-primary bg-opacity-10 text-primary me-3">
          <i class="bi bi-truck"></i>
</div>
  <div>
<h6 class="text-muted mb-1">Total Drivers</h6>
 <h3 class="mb-0">@Model.Count()</h3>
                 </div>
           </div>
   </div>
      </div>
        </div>
        <div class="col-md-3">
            <div class="card">
            <div class="card-body">
   <div class="d-flex align-items-center">
         <div class="stat-card-icon bg-success bg-opacity-10 text-success me-3">
           <i class="bi bi-check-circle"></i>
   </div>
   <div>
     <h6 class="text-muted mb-1">Active Drivers</h6>
          <h3 class="mb-0">@Model.Count(d => d.IsActive)</h3>
          </div>
        </div>
          </div>
 </div>
        </div>
        <div class="col-md-3">
   <div class="card">
             <div class="card-body">
           <div class="d-flex align-items-center">
     <div class="stat-card-icon bg-info bg-opacity-10 text-info me-3">
 <i class="bi bi-box-seam"></i>
   </div>
           <div>
   <h6 class="text-muted mb-1">Total Deliveries</h6>
    <h3 class="mb-0">@Model.Sum(d => d.TotalDeliveries)</h3>
            </div>
           </div>
 </div>
   </div>
</div>
        <div class="col-md-3">
     <div class="card">
         <div class="card-body">
         <div class="d-flex align-items-center">
      <div class="stat-card-icon bg-warning bg-opacity-10 text-warning me-3">
       <i class="bi bi-cash-stack"></i>
      </div>
  <div>
            <h6 class="text-muted mb-1">Pending Payments</h6>
         <h3 class="mb-0">@Model.Sum(d => d.CurrentBalance).ToString("N2")</h3>
             </div>
             </div>
  </div>
   </div>
        </div>
    </div>

    <!-- Drivers Table -->
    <div class="card">
        <div class="card-header bg-white">
   <h5 class="mb-0">All Drivers</h5>
        </div>
        <div class="card-body p-0">
            <div class="table-responsive">
   <table class="table table-hover mb-0">
   <thead class="table-light">
              <tr>
    <th>Driver</th>
    <th>Contact</th>
    <th>Vehicle</th>
 <th class="text-center">Deliveries</th>
     <th class="text-end">Current Balance</th>
           <th class="text-end">Total Earnings</th>
     <th class="text-center">Status</th>
             <th class="text-center">Actions</th>
              </tr>
       </thead>
               <tbody>
 @foreach (var driver in Model)
           {
    <tr>
        <td>
      <div class="d-flex align-items-center">
      <img src="https://ui-avatars.com/api/?name=@Uri.EscapeDataString(driver.FullName)&background=2563eb&color=fff"
            alt="@driver.FullName"
        class="rounded-circle me-2"
        width="32"
       height="32" />
             <div>
        <div class="fw-semibold">@driver.FullName</div>
      <small class="text-muted">@driver.Email</small>
   </div>
      </div>
        </td>
          <td>
               <div>
      <i class="bi bi-telephone"></i> @driver.PhoneNumber
    </div>
    @if (!string.IsNullOrEmpty(driver.Address))
            {
   <small class="text-muted">
    <i class="bi bi-geo-alt"></i> @driver.Address
     </small>
 }
       </td>
               <td>
  @if (!string.IsNullOrEmpty(driver.VehicleType))
    {
       <div>@driver.VehicleType</div>
    @if (!string.IsNullOrEmpty(driver.VehiclePlateNumber))
    {
           <small class="text-muted">@driver.VehiclePlateNumber</small>
        }
        }
   else
         {
            <span class="text-muted">Not set</span>
       }
        </td>
      <td class="text-center">
             <div>
        <span class="badge bg-primary">@driver.TotalDeliveries</span>
 </div>
    <small class="text-muted">This month: @driver.CurrentMonthDeliveries</small>
    </td>
      <td class="text-end">
     <strong class="@(driver.CurrentBalance > 0 ? "text-warning" : "")">
    @driver.CurrentBalance.ToString("N2")
               </strong>
           </td>
        <td class="text-end">
          <strong class="text-success">@driver.TotalEarnings.ToString("N2")</strong>
 </td>
           <td class="text-center">
      @if (driver.IsActive)
      {
      <span class="badge bg-success">Active</span>
       }
    else
   {
  <span class="badge bg-secondary">Inactive</span>
      }
    </td>
     <td class="text-center">
      <div class="btn-group btn-group-sm">
           <a asp-action="Details" asp-route-id="@driver.Id" class="btn btn-outline-primary" title="View Details">
     <i class="bi bi-eye"></i>
        </a>
         <a asp-action="Edit" asp-route-id="@driver.Id" class="btn btn-outline-secondary" title="Edit">
  <i class="bi bi-pencil"></i>
       </a>
           @if (driver.CurrentBalance > 0)
        {
              <a asp-action="PaySalary" asp-route-id="@driver.Id" class="btn btn-outline-success" title="Pay Salary">
    <i class="bi bi-cash"></i>
     </a>
     }
     </div>
</td>
  </tr>
  }
            </tbody>
              </table>
            </div>
        </div>
    </div>
}
